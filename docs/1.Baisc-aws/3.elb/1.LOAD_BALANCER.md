
## 네트워크

**네트워크**는 두 대 이상의 컴퓨터가 **통신 규칙 및 규약**을 통해 데이터를 주고받는 구조를 말한다. 쉽게 말해 여러 컴퓨터 장치들을 연결하여 정보와 자원을 교환하는 통신망을 구성한 것이 네트워크이다.  
  
오늘날 대표적인 전역 네트워크가 **인터넷(Internet)**인데, 전 세계의 수많은 컴퓨터와 서버가 통신망으로 연결된 거대한 네트워크이다. 네트워크를 이해하기 위해서는 **계층(layer)** 개념을 알아야 한다.   
  
통신의 복잡성을 관리하기 위해 국제 표준화 기구 ISO는 통신 과정을 일곱 단계로 나눈 **OSI 7 계층 모델**을 제안했는데, 물리 계층부터 응용 계층까지 각 계층이 맡은 역할을 정의한다.   
  
예를 들어, 가장 아래의 **물리 계층**은 전선이나 광케이블 등을 통해 **비트(bit)** 신호를 전송하는 역할을 하고, **데이터 링크 계층**은 이 비트들을 묶어 **프레임(frame)** 단위로 오류 검사와 흐름 제어를 수행한다.  
그 위의 **네트워크 계층**은 **패킷(packet)** 단위의 전송과 **경로 설정(라우팅)**을 담당하며, **전송 계층**은 송신자와 수신자 사이에 **종단 간 연결**을 맺고 **신뢰성 있는 데이터 전달**(예: 재전송, 순서 제어)을 보장한다. **세션 계층**과 **프레젠테이션 계층**은 응용 간 통신 세션 관리와 데이터 표현의 변환/암호화를 맡고, 최상위 **응용 계층**은 우리가 사용하는 웹, 이메일, FTP 등의 **응용 프로토콜**들이 동작하는 계층이다.

## OSI 7계층 모델(간단 개요)

OSI(Open Systems Interconnection) 모델은 네트워크 통신을 **7개의 계층**으로 나눠 설명하는 표준입니다.  
로드밸런서는 주로 **3, 4, 7계층**에서 동작하며, 각 계층의 특징은 다음과 같습니다.

| 계층 번호 | 계층 이름        | 주요 역할                                   |
|:--------:|:---------------|:-----------------------------------------|
| 7        | 애플리케이션 계층 | 사용자 애플리케이션 간 데이터 교환 (HTTP, FTP 등) |
| 6        | 표현 계층        | 데이터 인코딩·압축·암호화                      |
| 5        | 세션 계층        | 통신 세션(연결) 관리                          |
| 4        | 전송 계층        | 종단 간 신뢰성 있는 연결(TCP/UDP)              |
| 3        | 네트워크 계층     | IP 주소 기반 경로 결정·패킷 전달                |
| 2        | 데이터 링크 계층  | 물리적 네트워크 프레임 전송·에러 검출            |
| 1        | 물리 계층        | 실제 전기 신호·비트 전송                       |

### 로드밸런서와 연관된 계층
- **3계층 (네트워크)**: IP 헤더만 보고 트래픽을 분산
- **4계층 (전송)**: TCP/UDP 포트·연결 정보로 분산
- **7계층 (애플리케이션)**: HTTP 헤더·URL·쿠키 등 내용 기반 분산

---

## AWS ELB 유형 및 OSI 계층별 역할

### 1. Application Load Balancer (ALB) — L7 (애플리케이션)
- **OSI 레이어**: 7 (애플리케이션 계층)
- **무엇을 하나?**  
  웹사이트·API 트래픽(HTTP/HTTPS)을 **URL 경로, 호스트, 헤더** 등 애플리케이션 레벨에서 세밀하게 분산
- **비유**  
  쇼핑몰 입구에서 “의류 코너”, “가전 코너” 등 **문 앞 표지판** 보고 고객 안내하는 직원
- **주요 기능**
    - 호스트·경로·헤더 기반 라우팅
    - TLS 종료(SSL offload) → 백엔드 부담 ↓
    - 웹 방화벽(WAF) 연동 → 악성 요청 차단
    - 세션 스틱키니스(쿠키 기반)
- **언제 쓰는가?**  
  쇼핑몰, 블로그, REST API, WebSocket, gRPC 등 **HTTP 중심 서비스**

---

### 2. Network Load Balancer (NLB) — L4 (전송)
- **OSI 레이어**: 4 (전송 계층)
- **무엇을 하나?**  
  TCP/UDP 연결을 **초저지연·초고성능**으로 분산
- **비유**  
  고속도로 톨게이트의 **무정차 하이패스 시스템**처럼 빠르게 통과
- **주요 기능**
    - 수백만 TPS 처리·서브밀리초 지연
    - 고정 IP(Elastic IP) 지원
    - 클라이언트 원본 IP 그대로 전달
    - TLS 종료 또는 패스스루
- **언제 쓰는가?**  
  온라인 게임, 금융 트랜잭션, VoIP, IoT, gRPC 등 **속도와 연결 수**가 중요한 서비스

---

### 3. Gateway Load Balancer (GWLB) — L3 (네트워크)
- **OSI 레이어**: 3 (네트워크 계층)
- **무엇을 하나?**  
  방화벽·IDS/IPS 같은 **네트워크 보안 장비**를 트래픽 흐름 중간에 투명 체이닝
- **비유**  
  공항 보안 검색대 옆에 짐을 자동으로 이동시키는 **투명 터널**
- **주요 기능**
    - GENEVE 터널 캡슐화(IP over UDP)
    - 가상 방화벽·IDS 인스턴스 자동 확장
    - 5-tuple(flow) 단위 분산
- **언제 쓰는가?**  
  기업 네트워크 보안, DDoS 방어, 고성능 방화벽 체이닝 등 **보안 중심 환경**

---

## ELB 유형별 비교표

| 특성                | ALB (L7)               | NLB (L4)                | GWLB (L3)                       |
|:-------------------|:----------------------|:-----------------------|:-------------------------------|
| **OSI 계층**        | 7 (애플리케이션)        | 4 (전송)               | 3 (네트워크)                    |
| **지원 프로토콜**   | HTTP, HTTPS, HTTP/2, WebSocket, gRPC | TCP, TLS, UDP, TCP_UDP | GENEVE 터널(IP over UDP)        |
| **분산 기준**       | URL·호스트·헤더         | TCP/UDP 포트·연결 정보  | IP 경로 기반(터널링)            |
| **TLS 종료**        | ✅ (L7)               | ✅ 옵션 (L4)           | ❌                             |
| **고정 IP**         | ❌                     | ✅ Elastic IP 지원      | ✅ Endpoint를 통해 제공        |
| **세션 유지**       | ✅ (쿠키 기반)          | ❌                     | ❌                             |
| **성능/지연**       | 중간 (수천 TPS)         | 매우 높음 (수백만 TPS, 저지연) | 보안 장비 성능에 종속          |
| **주요 사용 사례**  | 웹/API, WebSocket, 인증, WAF | 게임, 금융, IoT, gRPC    | 방화벽·IDS/IPS 체이닝, 보안 집중 환경 |

---

## 최종 요약

- **OSI 모델**: 네트워크를 7계층으로 분리, 로드밸런서는 주로 3·4·7계층에서 동작
- **ALB (L7)**: HTTP/HTTPS 레벨 세밀 라우팅·TLS 종료·WAF 연동
- **NLB (L4)**: TCP/UDP 초저지연·고성능 분산·고정 IP 지원
- **GWLB (L3)**: 네트워크 보안 장비 체이닝·자동 확장·터널링
- **선택 기준**:
    - 웹/API 중심 → ALB
    - 대량·저지연 TCP/UDP → NLB
    - 보안 네트워크 체이닝 → GWLB
